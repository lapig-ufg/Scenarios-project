## Model Calibration and Validation Protocol

Scripts used:

⮕ [**`Model Simulation `**](Model_DinamicaEGO/04_Simulation_ExpanderPatcher.egomlx)

⮕ [**`Patch Metrics Calculation`**](Scripts/Landscape_metrics/CalcMetrics.ipynb)

⮕ [**`Model Validation`**](Model_DinamicaEGO/05_Validation_base.egomlx)

### 1. Model Construction and Change Allocation

The model was constructed using the transition matrices and spatial predictors previously defined. Expected land-use and land-cover (LULC) changes were allocated using the *Allocation Transition* submodel in Dinamica EGO, which spatially distributes the annual transition demands across the landscape.

The allocation process combines:
- Transition rates derived from the multiple-step transition matrix;
- Spatial probability maps generated by the Weights of Evidence approach, including distance-based calculations to LULC classes.
- Patch-based allocation mechanisms (*Expander* and *Patcher*), which control the spatial pattern of change.

---

### 2. Change Localization Process

The localization of changes is guided by transition-specific probability maps and by patch parameters that define whether changes occur as:
- **Expansion of existing patches (Expander)**, or 
- **Creation of new patches (Patcher)**.

To support the initial parameterization of these mechanisms, patch-based landscape metrics were calculated from observed LULC maps.

---

### 3. Auxiliary Patch Metrics Calculation

An auxiliary analysis was performed to quantify patch size, shape, and expansion behavior based on observed transitions between 2018 and 2023. This step aimed to provide an initial reference for configuring the *Expander* and *Patcher* parameters.

The procedure included:
- Identification of cells that underwent a specific transition;
- Detection of patches in the target class for both initial and final years;
- Classification of patches as *Expander* or *Patcher* based on spatial overlap;
- Calculation of patch metrics related to area, variability, and shape.

### 4. Model Calibration

Model calibration was conducted iteratively by adjusting the Expander and Patcher parameters. After each simulation run, the resulting landscape was visually and quantitatively compared to the observed 2023 LULC map.

#### Calibration focused on:

- Patch size distribution;

- Patch shape realism;

- Spatial coherence of changes.

If the simulated landscape exhibited unrealistic patterns (e.g., excessive fragmentation or overly compact patches) when compared to observed maps, the parameters were adjusted and the model re-run. This process continued until a landscape pattern considered realistic and consistent with observed dynamics was achieved, ensuring at least a minimum level of validation performance.

### Model Validation

Model validation was performed using a **fuzzy similarity approach** based on moving windows.

Given the spatial resolution of the LULC maps (30 m), a window size of 11 × 11 pixels was adopted, which balances local spatial detail and neighborhood context.

Two decay functions were considered:

- Exponential decay (primary criterion):

        Minimum similarity values ≥ 0.5 within the 11 × 11 window.

- Constant decay (secondary criterion):

        Minimum similarity values ≥ 0.4 within the same window.

The exponential decay function was prioritized because it is more conservative, assigning higher weights to closer pixels and penalizing spatial displacement more strongly. This makes it better suited for assessing the realism of spatial allocation in patch-based processes.

The constant decay function was only considered when exponential decay thresholds were not met, as it allows a more permissive interpretation of spatial similarity while still ensuring an acceptable level of agreement between simulated and observed maps.

### 6. Validation Acceptance Criteria

A simulation was considered acceptable when:

- Similarity values met or exceeded the defined thresholds under exponential decay; or

- In cases where exponential decay was overly restrictive, similarity values met the thresholds under constant decay.

This approach ensured a balance between model rigor and the inherent uncertainty associated with spatial allocation processes at a 30 m resolution.